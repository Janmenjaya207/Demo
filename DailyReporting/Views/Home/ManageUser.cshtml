@model DailyReporting.Models.Manageusermodel
@{
    ViewBag.Title = "ManageUser";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}


<style>
    .select{
        display:flex;
    }
    .btn2 {
        padding: 4px 4px !important;
        font-size: 10px !important;
    }
    .bank-detail {
        display: flex;
    }

        .bank-detail img {
            width: 100px;
            border-radius: 6px;
        }

    .custom-control {
        position: relative;
        display: block;
        min-height: 1.19437rem;
        padding-left: 46px;
    }

    .mtop {
        margin-top: 30px;
    }


    .demo > * {
        margin: 0 0 0 10px !important;
    }
</style>

<div class="subheader">
    <h1 class="subheader-title">
        <i class="subheader-icon fal fa-edit"></i>Create User

    </h1>
</div>
<div class="row">
    <div class="col-xl-12 sortable-grid ui-sortable">
        <div id="panel-1" class="panel panel-sortable" role="widget">
            <div class="panel-hdr" role="heading">
                <h2 class="ui-sortable-handle">
                    Create User
                </h2>

                <div class="panel-saving mr-2" style="display:none"><i class="fal fa-spinner-third fa-spin-4x fs-xl"></i></div><div class="panel-toolbar" role="menu"><a href="#" class="btn btn-panel hover-effect-dot js-panel-collapse waves-effect waves-themed" data-toggle="tooltip" data-offset="0,10" data-original-title="Collapse"></a> <a href="#" class="btn btn-panel hover-effect-dot js-panel-fullscreen waves-effect waves-themed" data-toggle="tooltip" data-offset="0,10" data-original-title="Fullscreen"></a> <a href="#" class="btn btn-panel hover-effect-dot js-panel-close waves-effect waves-themed" data-toggle="tooltip" data-offset="0,10" data-original-title="Close"></a></div><div class="panel-toolbar" role="menu"><a href="#" class="btn btn-toolbar-master waves-effect waves-themed" data-toggle="dropdown"><i class="fal fa-ellipsis-v"></i></a><div class="dropdown-menu dropdown-menu-animated dropdown-menu-right p-0"><a href="#" class="dropdown-item js-panel-refresh"><span data-i18n="drpdwn.refreshpanel">Refresh Content</span></a> <a href="#" class="dropdown-item js-panel-locked"><span data-i18n="drpdwn.lockpanel">Lock Position</span></a>  <div class="dropdown-multilevel dropdown-multilevel-left">											<div class="dropdown-item">												<span data-i18n="drpdwn.panelcolor">Panel Style</span>											</div>											<div class="dropdown-menu d-flex flex-wrap" style="min-width: 9.5rem; width: 9.5rem; padding: 0.5rem"><a href="#" class="btn d-inline-block bg-primary-700 bg-success-gradient width-2 height-2 p-0 rounded-0 js-panel-color hover-effect-dot waves-effect waves-themed" data-panel-setstyle="bg-primary-700 bg-success-gradient" style="margin:1px;"></a> <a href="#" class="btn d-inline-block bg-primary-500 bg-info-gradient width-2 height-2 p-0 rounded-0 js-panel-color hover-effect-dot waves-effect waves-themed" data-panel-setstyle="bg-primary-500 bg-info-gradient" style="margin:1px;"></a> <a href="#" class="btn d-inline-block bg-primary-600 bg-primary-gradient width-2 height-2 p-0 rounded-0 js-panel-color hover-effect-dot waves-effect waves-themed" data-panel-setstyle="bg-primary-600 bg-primary-gradient" style="margin:1px;"></a> <a href="#" class="btn d-inline-block bg-info-600 bg-primray-gradient width-2 height-2 p-0 rounded-0 js-panel-color hover-effect-dot waves-effect waves-themed" data-panel-setstyle="bg-info-600 bg-primray-gradient" style="margin:1px;"></a> <a href="#" class="btn d-inline-block bg-info-600 bg-info-gradient width-2 height-2 p-0 rounded-0 js-panel-color hover-effect-dot waves-effect waves-themed" data-panel-setstyle="bg-info-600 bg-info-gradient" style="margin:1px;"></a> <a href="#" class="btn d-inline-block bg-info-700 bg-success-gradient width-2 height-2 p-0 rounded-0 js-panel-color hover-effect-dot waves-effect waves-themed" data-panel-setstyle="bg-info-700 bg-success-gradient" style="margin:1px;"></a> <a href="#" class="btn d-inline-block bg-success-900 bg-info-gradient width-2 height-2 p-0 rounded-0 js-panel-color hover-effect-dot waves-effect waves-themed" data-panel-setstyle="bg-success-900 bg-info-gradient" style="margin:1px;"></a> <a href="#" class="btn d-inline-block bg-success-700 bg-primary-gradient width-2 height-2 p-0 rounded-0 js-panel-color hover-effect-dot waves-effect waves-themed" data-panel-setstyle="bg-success-700 bg-primary-gradient" style="margin:1px;"></a> <a href="#" class="btn d-inline-block bg-success-600 bg-success-gradient width-2 height-2 p-0 rounded-0 js-panel-color hover-effect-dot waves-effect waves-themed" data-panel-setstyle="bg-success-600 bg-success-gradient" style="margin:1px;"></a> <a href="#" class="btn d-inline-block bg-danger-900 bg-info-gradient width-2 height-2 p-0 rounded-0 js-panel-color hover-effect-dot waves-effect waves-themed" data-panel-setstyle="bg-danger-900 bg-info-gradient" style="margin:1px;"></a> <a href="#" class="btn d-inline-block bg-fusion-400 bg-fusion-gradient width-2 height-2 p-0 rounded-0 js-panel-color hover-effect-dot waves-effect waves-themed" data-panel-setstyle="bg-fusion-400 bg-fusion-gradient" style="margin:1px;"></a> <a href="#" class="btn d-inline-block bg-faded width-2 height-2 p-0 rounded-0 js-panel-color hover-effect-dot waves-effect waves-themed" data-panel-setstyle="bg-faded" style="margin:1px;"></a></div>										</div>  <div class="dropdown-divider m-0"></div><a href="#" class="dropdown-item js-panel-reset"><span data-i18n="drpdwn.resetpanel">Reset Panel</span></a></div></div>
            </div>
            <div class="panel-container show" role="content">
                <div class="loader"><i class="fal fa-spinner-third fa-spin-4x fs-xxl"></i></div>
                <div class="row mb-3">

                    <div class="col-md-12">
                        <form action="/Home/ManageUser" method="post" id="myform">

                            <div class="panel-content">
                                <div class="frame-wrap">
                                    @{string confirmMessage = Convert.ToString(TempData["Message"]); string warningMessage = Convert.ToString(TempData["WarningMessage"]);}
                                    @if (!string.IsNullOrEmpty(confirmMessage))
                                    {
                                        <div class="alert alert-success1 alert-dismissable" id="divSuccessMessage">
                                            <input type="hidden" id="messagealert" value="@confirmMessage" />
                                            @confirmMessage
                                            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                                        </div>
                                    }
                                    else if (!string.IsNullOrEmpty(warningMessage))
                                    {
                                        <div class="alert alert-warning1 alert-dismissable" id="divSuccessMessage">
                                            <input type="hidden" id="messagealert" value="@warningMessage" />
                                            @warningMessage
                                            <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                                        </div>
                                    }
                                    else
                                    {
                                        <input type="hidden" id="messagealert" value="0" />
                                    }
                                    <div class="card p-3">
                                        <div class="row mb-2">
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label class="form-label" for="example-select">Name:</label>
                                                    @Html.HiddenFor(m => m.Manage_User.UserId, new { @class = "form-control", @id = "UserId" })
                                                    @Html.TextBoxFor(x => x.Manage_User.FirstName, new { @class = "form-control", @required = "true", @name = "FirstName", @id = "FirstName" })
                                                </div>
                                            </div>

                                            @*<div class="col-md-4">
                                                    <div class="form-group">
                                                        <label class="form-label" for="example-select">Last Name:</label>
                                                        @Html.TextBoxFor(x => x.Manage_User.LastName, new { @class = "form-control", @required = "true", @name = "LastName", @id = "LastName" })
                                                    </div>
                                                </div>*@
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label class="form-label" for="example-select">User Type:</label>
                                                    @Html.DropDownListFor(x => x.Manage_User.UserTypeId, Model.Usertype, new { @class = "form-control", @id = "Usertype" })
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label class="form-label" for="example-select">User Name:</label>
                                                    @Html.TextBoxFor(x => x.Manage_User.UserName, new { @class = "form-control", @required = "true", @name = "UserName", @id = "UserName" })
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row mb-2">


                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label class="form-label" for="example-select">Password:</label>
                                                    @Html.TextBoxFor(x => x.Manage_User.Password, new { @class = "form-control", @required = "true", @name = "Password", @id = "Password" })
                                                </div>
                                            </div>

                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label class="form-label" for="example-select">Confirm Password:</label>
                                                    @Html.TextBoxFor(x => x.Manage_User.Password, new { @class = "form-control", @required = "true", @name = "Confirm", @id = "Confirm", @Onchange = "Binddata()" })
                                                </div>
                                            </div>
                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label class="form-label" for="example-select">Mobile Number:</label>
                                                    @Html.TextBoxFor(x => x.Manage_User.MobileNo, new { @class = "form-control", @required = "true", @name = "MobileNo", @id = "MobileNo", @maxlength = "10" })
                                                </div>
                                            </div>

                                        </div>
                                        <div class="row mb-2">


                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label class="form-label" for="example-select">Email ID:</label>
                                                    @Html.TextBoxFor(x => x.Manage_User.Emaild, new { @class = "form-control", @required = "true", @name = "Emaild", @id = "Emaild", @onchange = "ValidateEmail()" })
                                                </div>
                                            </div>

                                            <div class="col-md-4">
                                                <div class="form-group">
                                                    <label class="form-label" for="example-select">Address:</label>
                                                    @Html.TextAreaFor(x => x.Manage_User.Address, new { @class = "form-control", @required = "true", @name = "Address", @id = "Address" })
                                                </div>
                                            </div>

                                        </div>
                                        <div class="row mt-2">
                                            <div class="col-md-12">
                                                <button type="button" class="btn btn-warning waves-effect waves-themed" style="float:right;" onclick="location.reload()">Cancel</button>
                                                <button type="submit" id="button" class="btn btn-primary waves-effect waves-themed" style="float:right;margin-right:12px;">Submit</button>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-xl-12">
        <div id="panel-1" class="panel">

            <div class="panel-hdr">
                <h2>
                    Employee Details <span class="fw-300"><i>List</i></span>
                </h2>
            </div>
            <div class="panel-container show">
                <div class="panel-content">
                    <!-- datatable start -->
                    <div class="table-responsive">
                        <table id="example2" class="table table-striped table-bordered table-responsive">
                            <thead class="bg-info-700">
                                <tr>
                                    <th>Sl no</th>
                                    <th>Name</th>
                                    @*<th>Last Name</th>*@
                                    <th>User Type</th>
                                    <th>User Name</th>
                                    <th>Password</th>
                                    <th>Mobile No.</th>
                                    <th>Emai Id</th>
                                    <th>Address</th>
                                    @*<th>Action</th>*@
                                </tr>
                            </thead>
                            <tbody>
                                @{ int count = 0;}
                                @if (ViewBag.mngdtl != null)
                                {
                                    foreach (var iteam in ViewBag.mngdtl)
                                    {
                                        count = count + 1;
                                        <tr>
                                            <td>@count</td>
                                            <td>@iteam.FirstName</td>
                                            @*<td>@iteam.LastName</td>*@
                                            <td>@iteam.UserTypeName</td>
                                            <td>@iteam.UserName</td>
                                            <td>@iteam.Password</td>
                                            <td>@iteam.MobileNo</td>
                                            <td>@iteam.Emaild</td>
                                            <td>@iteam.Address</td>
                                            @*<td>
                                                <div class="list-icons">
                                                    <div class="dropdown">
                                                        <a href="#" class="list-icons-item" data-toggle="dropdown">
                                                            <i class="icon-menu9"></i>
                                                        </a>
                                                        <div class="select">
                                                            <a href="#" onclick="Edit(@iteam.UserId)" class="btn btn-outline-primary waves-effect waves-light m-1 btn2"><i class="fal fa-edit"></i> Edit</a>
                                                            <a href="~/Home/DeleteManageUser/@iteam.UserId" onclick="return confirm('Are you sure want to delete this record?')" class="btn btn-outline-primary waves-effect waves-light m-1 btn2"><i class="fal fa-trash"></i> Delete</a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>*@
                                        </tr>
                                    }
                                }

                            </tbody>

                        </table>
                    </div>
                    <!-- datatable end -->
                </div>
            </div>
        </div>
    </div>
</div>

<script src="~/Scripts/jquery-3.3.1.min.js"></script>
<script>
    function Edit(id) {
        debugger;
        $.ajax({
            type: "POST",
            url: "/Home/EditManageUser",
            data: { id: id },
            dataType: "json",
            success: function (data) {
                debugger;
                $("#button").text("Update");
                $("#UserId").val(data.UserId);
                $("#FirstName").val(data.FirstName);
                //$("#LastName").val(data.LastName);
                //$("#Usertype").val(data.UserTypeName);
                $("#UserName").val(data.UserName);
                $("#Password").val(data.Password);
                $("#Confirm").val(data.Password);
                $("#MobileNo").val(data.MobileNo);
                $("#Emaild").val(data.Emaild);
                $("#Address").val(data.Address);
            }
        });
    }
</script>
<script>
    function Binddata() {
        var data = $("#Password").val();
        var data1 = $("#Confirm").val();
        if (data != data1) {
            alert("Password Doesn't Match");
        }
    }
</script>
<script type="text/javascript">
    $("#button").click(function () {
        debugger;
        var count = 0;
        var FirstName = $("#FirstName").val();
        var Usertype = $("#Usertype").val();
        var UserName = $("#UserName").val();
        var Password = $("#Password").val();
        var Confirm = $("#Confirm").val();
        var MobileNo = $("#MobileNo").val();
        var Emaild = $("#Emaild").val();
        //var Address = $("#Address").val();

        if (FirstName == "") {
            $('#FirstName').next("label").remove();
            $('#FirstName').after('<label class="error mt-2 text-danger1 ">Please Enter Name</label>');
            $("#FirstName").focus();
            count = 1;
            return false;
        }
        else {
            $('#FirstName').next("label").remove();
        }
        if (Usertype == 0) {
            $('#Usertype').next("label").remove();
            $('#Usertype').after('<label class="error mt-2 text-danger1 ">Please Select User Type</label>');
            $("#Usertype").focus();
            count = 1;
            return false;
        }
        else {
            $('#Usertype').next("label").remove();
        }
        if (UserName == "") {
            $('#UserName').next("label").remove();
            $('#UserName').after('<label class="error mt-2 text-danger1 ">Please Enter User Name</label>');
            $("#UserName").focus();
            count = 1;
            return false;
        }
        else {
            $('#UserName').next("label").remove();
        }
        if (Password == "") {
            $('#Password').next("label").remove();
            $('#Password').after('<label class="error mt-2 text-danger1 ">Please Enter Password</label>');
            $("#Password").focus();
            count = 1;
            return false;
        }
        else {
            $('#Password').next("label").remove();
        }
        if (Confirm == "") {
            $('#Confirm').next("label").remove();
            $('#Confirm').after('<label class="error mt-2 text-danger1 ">Please Enter Confirm Password</label>');
            $("#Confirm").focus();
            count = 1;
            return false;
        }
        else {
            $('#Confirm').next("label").remove();
        }
        if (MobileNo == "") {
            $('#MobileNo').next("label").remove();
            $('#MobileNo').after('<label class="error mt-2 text-danger1 ">Please Enter Mobile Number</label>');
            $("#MobileNo").focus();
            count = 1;
            return false;
        }
        else {
            $('#MobileNo').next("label").remove();
        }
        if (Emaild == "") {
            $('#Emaild').next("label").remove();
            $('#Emaild').after('<label class="error mt-2 text-danger1">Please Enter Email Id</label>');
            $("#Emaild").focus();
            count = 1;
            return false;
        }
        else {
            if (ValidateEmail(Emaild)) {
                $("#Emaild").next("label").remove();
            }
            else {
                $("#Emaild").next("label").remove();
                $("#Emaild").after('<label class="error mt-2 text-danger1">Please Enter Valid Email Id</label>');
                $("#Emaild").focus();
                count = 1;
                return false;
            }
        }
        //if (Address == "") {
        //    $('#Address').next("label").remove();
        //    $('#Address').after('<label class="error mt-2 text-danger1 ">Please Enter Address</label>');
        //    $("#Address").focus();
        //    count = 1;
        //    return false;
        //}
        //else {
        //    $('#Address').next("label").remove();
        //}
    });

    function ValidateEmail(Emaild) {

        var emailReg = /^([\w-\.]+)@@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;
        if (!emailReg.test(Emaild)) { return false; }
        else { return true; }
    }
</script>

